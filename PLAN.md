# План реализации программы ChatList

## Этап 1: Настройка проекта и базы данных

### 1.1 Инициализация проекта
- [ ] Создать структуру директорий проекта
- [ ] Создать файл `requirements.txt` с зависимостями (PyQt5, requests/httpx, python-dotenv)
- [ ] Создать файл `.env.example` с примером переменных окружения для API-ключей
- [ ] Создать файл `.gitignore` для исключения `.env` и других служебных файлов

### 1.2 Реализация модуля базы данных (db.py)
- [ ] Создать класс для работы с SQLite
- [ ] Реализовать метод инициализации БД (создание таблиц)
- [ ] Реализовать методы для работы с таблицей `prompts`:
  - [ ] Добавление промта
  - [ ] Получение списка промтов
  - [ ] Поиск промтов
  - [ ] Сортировка промтов
- [ ] Реализовать методы для работы с таблицей `models`:
  - [ ] Добавление модели
  - [ ] Получение списка моделей
  - [ ] Получение активных моделей (is_active=1)
  - [ ] Обновление статуса модели
  - [ ] Поиск и сортировка моделей
- [ ] Реализовать методы для работы с таблицей `results`:
  - [ ] Сохранение результата
  - [ ] Получение списка результатов
  - [ ] Поиск результатов
  - [ ] Сортировка результатов
- [ ] Реализовать методы для работы с таблицей `settings`:
  - [ ] Сохранение настройки
  - [ ] Получение настройки

## Этап 2: Работа с API нейросетей

### 2.1 Реализация модуля network.py
- [ ] Создать базовый класс для работы с API
- [ ] Реализовать загрузку API-ключей из `.env` файла
- [ ] Реализовать поддержку разных типов моделей:
  - [ ] OpenAI API
  - [ ] DeepSeek API
  - [ ] Groq API
  - [ ] (Опционально) Другие API
- [ ] Реализовать метод отправки промта в модель
- [ ] Реализовать обработку ошибок и таймаутов
- [ ] Реализовать логирование запросов (опционально)

### 2.2 Реализация модуля models.py
- [ ] Создать класс для представления модели нейросети
- [ ] Реализовать методы для получения списка моделей из БД
- [ ] Реализовать фильтрацию активных моделей
- [ ] Реализовать валидацию конфигурации моделей

## Этап 3: Реализация пользовательского интерфейса

### 3.1 Основной интерфейс (main.py)
- [ ] Создать главное окно приложения
- [ ] Реализовать область ввода промта:
  - [ ] Текстовое поле для ввода нового промта
  - [ ] Выпадающий список для выбора сохранённого промта
  - [ ] Кнопка "Отправить"
- [ ] Реализовать область выбора моделей:
  - [ ] Список моделей с чекбоксами для выбора активных
  - [ ] Кнопка "Настроить модели" (для управления моделями)
- [ ] Реализовать таблицу результатов:
  - [ ] Колонки: название модели, текст ответа, чекбокс selected
  - [ ] Возможность прокрутки для длинных ответов
  - [ ] Кнопка "Сохранить выбранные"
- [ ] Реализовать меню и панель инструментов:
  - [ ] Меню "Файл" (экспорт, выход)
  - [ ] Меню "Настройки"
  - [ ] Меню "Справка"

### 3.2 Дополнительные окна
- [ ] Окно управления моделями:
  - [ ] Добавление новой модели
  - [ ] Редактирование существующей модели
  - [ ] Удаление модели
  - [ ] Активация/деактивация модели
- [ ] Окно просмотра сохранённых результатов:
  - [ ] Таблица с сохранёнными результатами
  - [ ] Поиск и фильтрация
  - [ ] Сортировка
- [ ] Окно управления промтами:
  - [ ] Просмотр сохранённых промтов
  - [ ] Редактирование промтов
  - [ ] Добавление тегов
  - [ ] Удаление промтов

## Этап 4: Интеграция компонентов

### 4.1 Связывание компонентов
- [ ] Интегрировать db.py с main.py
- [ ] Интегрировать network.py с main.py
- [ ] Интегрировать models.py с main.py
- [ ] Реализовать обработку событий:
  - [ ] Отправка промта в выбранные модели
  - [ ] Отображение результатов во временной таблице
  - [ ] Сохранение выбранных результатов
  - [ ] Очистка временной таблицы при новом запросе

### 4.2 Обработка ошибок
- [ ] Обработка ошибок подключения к БД
- [ ] Обработка ошибок API запросов
- [ ] Отображение понятных сообщений об ошибках пользователю
- [ ] Логирование ошибок

## Этап 5: Дополнительные функции

### 5.1 Поиск и сортировка
- [ ] Реализовать поиск в таблице промтов
- [ ] Реализовать поиск в таблице моделей
- [ ] Реализовать поиск в таблице результатов
- [ ] Реализовать сортировку по всем колонкам

### 5.2 Экспорт данных
- [ ] Реализовать экспорт результатов в Markdown
- [ ] Реализовать экспорт результатов в JSON
- [ ] Добавить диалог выбора файла для экспорта

### 5.3 Логирование (опционально)
- [ ] Реализовать логирование всех запросов к API
- [ ] Сохранение логов в файл
- [ ] Просмотр логов в интерфейсе

### 5.4 AI-ассистент для улучшения промтов
- [ ] Создать модуль `prompt_improver.py`:
  - [ ] Класс `PromptImprover` для работы с улучшением промтов
  - [ ] Метод для формирования промпта-запроса к AI для улучшения
  - [ ] Метод для отправки запроса в выбранную модель через NetworkClient
  - [ ] Метод для парсинга ответа AI (извлечение улучшенной версии и вариантов)
  - [ ] Метод для адаптации промта под разные типы задач (код, анализ, креатив)
- [ ] Создать UI-модуль `ui_prompt_improver_dialog.py`:
  - [ ] Диалоговое окно для отображения результатов улучшения
  - [ ] Область отображения исходного промта (read-only)
  - [ ] Область отображения улучшенной версии промта
  - [ ] Список альтернативных вариантов (2-3 варианта переформулировки)
  - [ ] Опционально: варианты адаптации под типы задач (код, анализ, креатив)
  - [ ] Кнопки действий:
    - [ ] "Подставить улучшенный" - подставляет улучшенную версию в поле ввода
    - [ ] "Подставить вариант N" - подставляет выбранный альтернативный вариант
    - [ ] "Сохранить как новый промт" - сохраняет выбранный вариант в БД
    - [ ] "Закрыть" - закрывает диалог
- [ ] Интеграция в главное окно (main.py):
  - [ ] Добавить кнопку "Улучшить промт" рядом с полем ввода промта
  - [ ] Реализовать обработчик нажатия кнопки:
    - [ ] Проверка наличия текста в поле ввода
    - [ ] Выбор модели для улучшения (можно использовать первую активную или добавить настройку)
    - [ ] Показ индикатора загрузки во время обработки
    - [ ] Открытие диалога с результатами улучшения
  - [ ] Реализовать метод подстановки текста в поле ввода из диалога
- [ ] Настройки для AI-ассистента:
  - [ ] Добавить в таблицу settings настройку "prompt_improver_model_id" (ID модели для улучшения)
  - [ ] Добавить возможность выбора модели для улучшения в настройках или в диалоге
  - [ ] Сохранение предпочтений пользователя (какой вариант использовать по умолчанию)
- [ ] Обработка ошибок:
  - [ ] Обработка ошибок API при запросе улучшения
  - [ ] Обработка случая, когда модель не выбрана
  - [ ] Обработка случая, когда ответ AI не может быть распарсен
  - [ ] Понятные сообщения об ошибках пользователю
- [ ] Оптимизация промптов для AI-ассистента:
  - [ ] Создать шаблоны промптов для разных типов улучшения:
    - [ ] Общее улучшение промта
    - [ ] Переформулировка (2-3 варианта)
    - [ ] Адаптация под код
    - [ ] Адаптация под анализ
    - [ ] Адаптация под креативные задачи
  - [ ] Реализовать выбор шаблона в зависимости от потребностей пользователя
- [ ] Тестирование:
  - [ ] Тестирование улучшения простых промтов
  - [ ] Тестирование улучшения сложных промтов
  - [ ] Тестирование различных типов задач
  - [ ] Тестирование обработки ошибок
  - [ ] Тестирование UI-компонентов

## Этап 6: Тестирование и доработка

### 6.1 Тестирование функциональности
- [ ] Тестирование работы с БД
- [ ] Тестирование отправки запросов к API
- [ ] Тестирование интерфейса
- [ ] Тестирование обработки ошибок

### 6.2 Оптимизация и доработка
- [ ] Оптимизация производительности
- [ ] Улучшение пользовательского интерфейса
- [ ] Добавление подсказок и справки
- [ ] Финальная проверка всех функций

## Этап 7: Документация и финализация

### 7.1 Документация
- [ ] Создать README.md с инструкциями по установке и использованию
- [ ] Добавить комментарии в код
- [ ] Создать документацию по API модулей

### 7.2 Финальная проверка
- [ ] Проверка соответствия спецификации PROJECT.md
- [ ] Проверка всех требований
- [ ] Подготовка к релизу


